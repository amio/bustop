{"version":3,"sources":["webpack:///app.8c466e1a.js","webpack:///./src/components/App.js","webpack:///./src/components/StopLinePanel.js","webpack:///./src/components/api.js","webpack:///./src/index.js"],"names":["webpackJsonp","0","module","exports","__webpack_require__","VTUT","YCZr","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","parseLocationHash","locationHash","stopLines","split","map","lineStop","_lineStop$split","lineid","direction","stopid","e","undefined","_preact","_StopLinePanel","_StopLinePanel2","App","_Component","this","apply","arguments","componentDidMount","window","location","hash","setState","render","props","state","h","className","line","data","Component","uY7q","4t7O","_api","StopLinePanel","_this2","_props$data","fetchBusLine","then","res","buslines","currentLine","lineResults0","lineResults1","fetchBusStop","bus","renderBusActivity","terminal","stopdis","time","parseInt","_props$data2","stop","stops","cars","zdmc","VTQS","busLineApi","_axios2","get","busStopApi","_axios","cilB","lVK7","init","root","document","querySelector"],"mappings":"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","file":"app.8c466e1a.js","sourcesContent":["webpackJsonp([0,2],{\n\n/***/ 0:\n/***/ function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(\"fuAh\");\n\tmodule.exports = __webpack_require__(\"lVK7\");\n\n\n/***/ },\n\n/***/ \"VTUT\":\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ },\n\n/***/ \"YCZr\":\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\texports.__esModule = true;\n\texports.default = undefined;\n\t\n\t__webpack_require__(\"VTUT\");\n\t\n\tvar _preact = __webpack_require__(\"EF6w\");\n\t\n\tvar _StopLinePanel = __webpack_require__(\"4t7O\");\n\t\n\tvar _StopLinePanel2 = _interopRequireDefault(_StopLinePanel);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar App = function (_Component) {\n\t  _inherits(App, _Component);\n\t\n\t  function App() {\n\t    _classCallCheck(this, App);\n\t\n\t    return _possibleConstructorReturn(this, _Component.apply(this, arguments));\n\t  }\n\t\n\t  App.prototype.componentDidMount = function componentDidMount() {\n\t    var stopLines = parseLocationHash(window.location.hash);\n\t    if (stopLines) {\n\t      this.setState({\n\t        stopLines: stopLines\n\t      });\n\t    }\n\t  };\n\t\n\t  App.prototype.render = function render(props, state) {\n\t    return h(\n\t      'div',\n\t      { className: 'App' },\n\t      state.stopLines || h(\n\t        'span',\n\t        null,\n\t        'Loading...'\n\t      ),\n\t      state.stopLines && state.stopLines.map(function (line) {\n\t        return h(_StopLinePanel2.default, { data: line });\n\t      })\n\t    );\n\t  };\n\t\n\t  return App;\n\t}(_preact.Component);\n\t\n\t/**\n\t * Parse window.location.hash to structure data\n\t * @param  {String} locationHash window.location.hash ('#/sh/765-0-15,985-1-5')\n\t * @return {Array}               Multiple lines within a bus stop.\n\t *                               [\n\t *                                  {lineid: 765, direction: 0, stopid: 15},\n\t *                                  {lineid: 985, direction: 1, stopid: 5}\n\t *                               ]\n\t */\n\t\n\t\n\texports.default = App;\n\tfunction parseLocationHash(locationHash) {\n\t  try {\n\t    var stopLines = locationHash.split('/')[2].split(',');\n\t    return stopLines.map(function (lineStop) {\n\t      var _lineStop$split = lineStop.split('-'),\n\t          lineid = _lineStop$split[0],\n\t          direction = _lineStop$split[1],\n\t          stopid = _lineStop$split[2];\n\t\n\t      return { lineid: lineid, direction: direction, stopid: stopid };\n\t    });\n\t  } catch (e) {\n\t    return false;\n\t  }\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n\n/***/ \"uY7q\":\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ },\n\n/***/ \"4t7O\":\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\texports.__esModule = true;\n\texports.default = undefined;\n\t\n\tvar _preact = __webpack_require__(\"EF6w\");\n\t\n\tvar _api = __webpack_require__(\"VTQS\");\n\t\n\t__webpack_require__(\"uY7q\");\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar StopLinePanel = function (_Component) {\n\t  _inherits(StopLinePanel, _Component);\n\t\n\t  function StopLinePanel() {\n\t    _classCallCheck(this, StopLinePanel);\n\t\n\t    return _possibleConstructorReturn(this, _Component.apply(this, arguments));\n\t  }\n\t\n\t  StopLinePanel.prototype.componentDidMount = function componentDidMount() {\n\t    var _this2 = this;\n\t\n\t    var _props$data = this.props.data,\n\t        lineid = _props$data.lineid,\n\t        direction = _props$data.direction,\n\t        stopid = _props$data.stopid;\n\t\n\t    (0, _api.fetchBusLine)(lineid).then(function (res) {\n\t      return _this2.setState({\n\t        buslines: res.data,\n\t        currentLine: !direction ? res.data.lineResults1 : res.data.lineResults0\n\t      });\n\t    });\n\t\n\t    (0, _api.fetchBusStop)(lineid, direction, stopid).then(function (res) {\n\t      return _this2.setState({\n\t        bus: res.data\n\t      });\n\t    });\n\t  };\n\t\n\t  StopLinePanel.prototype.renderBusActivity = function renderBusActivity(props) {\n\t    if (props) {\n\t      var terminal = props.terminal,\n\t          stopdis = props.stopdis,\n\t          time = props.time;\n\t\n\t      return terminal + ' \\u8FD8\\u6709' + stopdis + '\\u7AD9\\uFF0C\\u7EA6' + parseInt(time / 60, 10) + '\\u5206\\u949F';\n\t    } else if (this.state.bus) {\n\t      // bus.cars.length = 0\n\t      return '等待发车';\n\t    } else {\n\t      return '更新线路信息……';\n\t    }\n\t  };\n\t\n\t  StopLinePanel.prototype.render = function render(props, state) {\n\t    var _props$data2 = props.data,\n\t        lineid = _props$data2.lineid,\n\t        stopid = _props$data2.stopid;\n\t\n\t    var stop = state.currentLine && state.currentLine.stops[stopid - 1];\n\t    var bus = state.bus && state.bus.cars[0];\n\t\n\t    return h(\n\t      'div',\n\t      { className: 'stopline-panel' },\n\t      h(\n\t        'div',\n\t        { className: 'title-row' },\n\t        h(\n\t          'div',\n\t          { className: 'line-name' },\n\t          lineid\n\t        ),\n\t        h(\n\t          'div',\n\t          { className: 'stop-name' },\n\t          stop && stop.zdmc\n\t        )\n\t      ),\n\t      h(\n\t        'div',\n\t        { className: 'state-row' },\n\t        this.renderBusActivity(bus)\n\t      )\n\t    );\n\t  };\n\t\n\t  return StopLinePanel;\n\t}(_preact.Component);\n\t\n\texports.default = StopLinePanel;\n\tmodule.exports = exports['default'];\n\n/***/ },\n\n/***/ \"VTQS\":\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\texports.__esModule = true;\n\texports.fetchBusStop = exports.fetchBusLine = undefined;\n\t\n\tvar _axios = __webpack_require__(\"mtWM\");\n\t\n\tvar _axios2 = _interopRequireDefault(_axios);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction fetchBusLine(lineid) {\n\t  var busLineApi = 'https://busline.now.sh/sh/line?line=' + lineid;\n\t  return _axios2.default.get(busLineApi);\n\t}\n\t\n\tfunction fetchBusStop(lineid, direction, stopid) {\n\t  var busStopApi = 'https://busline.now.sh/sh/stop?line=' + lineid + '&direction=' + direction + '&stop=' + stopid;\n\t  return _axios2.default.get(busStopApi);\n\t}\n\t\n\texports.fetchBusLine = fetchBusLine;\n\texports.fetchBusStop = fetchBusStop;\n\n/***/ },\n\n/***/ \"cilB\":\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ },\n\n/***/ \"lVK7\":\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(\"cilB\");\n\t\n\tvar _preact = __webpack_require__(\"EF6w\");\n\t\n\twindow.h = _preact.h;\n\t\n\tvar root = void 0;\n\tfunction init() {\n\t  var App = __webpack_require__(\"YCZr\");\n\t  root = (0, _preact.render)((0, _preact.h)(App, null), document.querySelector('#app'), root);\n\t}\n\t\n\tinit();\n\t\n\tif (false) {\n\t  module.hot.accept('./components/App', function () {\n\t    return window.requestAnimationFrame(function () {\n\t      init();\n\t    });\n\t  });\n\t}\n\n/***/ }\n\n});\n\n\n// WEBPACK FOOTER //\n// app.8c466e1a.js","import './App.css'\n\nimport { Component } from 'preact'\nimport StopLinePanel from './StopLinePanel'\n\nexport default class App extends Component {\n  componentDidMount () {\n    const stopLines = parseLocationHash(window.location.hash)\n    if (stopLines) {\n      this.setState({\n        stopLines: stopLines\n      })\n    }\n  }\n  render (props, state) {\n    return <div className='App'>\n      { state.stopLines || <span>Loading...</span> }\n      { state.stopLines && state.stopLines.map(line => <StopLinePanel data={line} />)}\n    </div>\n  }\n}\n\n/**\n * Parse window.location.hash to structure data\n * @param  {String} locationHash window.location.hash ('#/sh/765-0-15,985-1-5')\n * @return {Array}               Multiple lines within a bus stop.\n *                               [\n *                                  {lineid: 765, direction: 0, stopid: 15},\n *                                  {lineid: 985, direction: 1, stopid: 5}\n *                               ]\n */\nfunction parseLocationHash (locationHash) {\n  try {\n    const stopLines = locationHash.split('/')[2].split(',')\n    return stopLines.map(lineStop => {\n      const [lineid, direction, stopid] = lineStop.split('-')\n      return {lineid, direction, stopid}\n    })\n  } catch (e) {\n    return false\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/App.js","import { Component } from 'preact'\nimport { fetchBusLine, fetchBusStop } from './api'\nimport './StopLinePanel.css'\n\nexport default class StopLinePanel extends Component {\n  componentDidMount () {\n    const { lineid, direction, stopid } = this.props.data\n    fetchBusLine(lineid).then(res => this.setState({\n      buslines: res.data,\n      currentLine: !direction\n        ? res.data.lineResults1\n        : res.data.lineResults0\n    }))\n\n    fetchBusStop(lineid, direction, stopid)\n    .then(res => this.setState({\n      bus: res.data\n    }))\n  }\n  renderBusActivity (props) {\n    if (props) {\n      const { terminal, stopdis, time } = props\n      return `${terminal} 还有${stopdis}站，约${parseInt(time / 60, 10)}分钟`\n    } else if (this.state.bus) { // bus.cars.length = 0\n      return '等待发车'\n    } else {\n      return '更新线路信息……'\n    }\n  }\n  render (props, state) {\n    const { lineid, stopid } = props.data\n    const stop = state.currentLine && state.currentLine.stops[stopid - 1]\n    const bus = state.bus && state.bus.cars[0]\n\n    return <div className='stopline-panel'>\n      <div className='title-row'>\n        <div className='line-name'>{ lineid }</div>\n        <div className='stop-name'>{ stop && stop.zdmc }</div>\n      </div>\n      <div className='state-row'>\n        { this.renderBusActivity(bus) }\n      </div>\n    </div>\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/StopLinePanel.js","import axios from 'axios'\n\nfunction fetchBusLine (lineid) {\n  const busLineApi = `https://busline.now.sh/sh/line?line=${lineid}`\n  return axios.get(busLineApi)\n}\n\nfunction fetchBusStop (lineid, direction, stopid) {\n  const busStopApi = `https://busline.now.sh/sh/stop?line=${lineid}&direction=${direction}&stop=${stopid}`\n  return axios.get(busStopApi)\n}\n\nexport {\n  fetchBusLine,\n  fetchBusStop\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/api.js","import './index.css'\n\nimport { h, render } from 'preact'\nwindow.h = h\n\nlet root\nfunction init () {\n  let App = require('./components/App')\n  root = render(<App />, document.querySelector('#app'), root)\n}\n\ninit()\n\nif (module.hot) {\n  module.hot.accept('./components/App', () => window.requestAnimationFrame(() => {\n    init()\n  }))\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}